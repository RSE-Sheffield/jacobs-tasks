<!DOCTYPE html>
<html>

  <head>
    <script src="jspsych/jspsych.js"></script>
    <script src="jspsych/plugin-html-keyboard-response.js"></script>
    <script src="config/expt1_config.js"></script>
    <link href="jspsych/jspsych.css" rel="stylesheet" type="text/css" />
  </head>

  <body>
    <canvas id="canvas" width="500" height="500">
    </canvas>

    <script>

        const canvas = document.getElementById("canvas");
        const jsPsych = initJsPsych();

        var nStimuli = config.startValue
        
        var timeline = [];

        // Standard fixation object
        var fixation = {
            type: jsPsychHtmlKeyboardResponse,
            stimulus: '<div style="font-size:60px;">+</div>',
            choices: "NO_KEYS",
            trial_duration: config.fixationDuration,
            data: {
                screen: 'fixation'
            }
        };

        // Generate target array
        var target_array = {
            type: jsPsychCanvasButtonResponse,
            // Befre each run shuffle the available colours and split into used
            // and unused
            on_start: function(trial){
                shuffColours = jsPsych.randomization.shuffle(config.colours)
                usedCols = shuffColours.slice(0, nStimuli)
                unusedCols = shuffColours.slice(nStimuli, )
            },
            // Draw the used colours on screen
            stimulus: function(c) {
                drawRects(c, usedCols);
            },
            canvas_size: [canvas.width, canvas.height],
            trial_duration: config.stimulusDuration,
            post_trial_gap: config.blankDuration,
            data: {
                screen: "memory array"
            },
            choices: []
        }

        var expt1_procedure = {
            timeline: [
                fixation,
            ],
        }; 

        timeline.push(expt1_procedure)

        jsPsych.run(timeline)


    </script>

  </body>

</html>
